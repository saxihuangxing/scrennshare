(window.webpackJsonp=window.webpackJsonp||[]).push([[6],{1017:function(e,t,a){var n={"./ar":983,"./ar.js":983,"./de":984,"./de.js":984,"./es":985,"./es.js":985,"./fr":986,"./fr.js":986,"./hi":987,"./hi.js":987,"./it":988,"./it.js":988,"./ja":989,"./ja.js":989,"./ko":990,"./ko.js":990,"./pt":991,"./pt.js":991,"./ru":992,"./ru.js":992,"./zh-cn":993,"./zh-cn.js":993,"./zh-hk":994,"./zh-hk.js":994,"./zh-tw":995,"./zh-tw.js":995};function r(e){var t=i(e);return a(t)}function i(e){var t=n[e];if(!(t+1)){var a=new Error("Cannot find module '"+e+"'");throw a.code="MODULE_NOT_FOUND",a}return t}r.keys=function e(){return Object.keys(n)},r.resolve=i,e.exports=r,r.id=1017},1073:function(e,t,a){"use strict";a.r(t);var n=a(1),r=a.n(n),i=a(975),o=a(976),l=a(974),s=a(973),u=a(185),c=a(64),f=a(184),p=a.n(f),m=a(970),d=a(88),h=a(972),y=a(122),g=a(145),b=a(43),v=a(186),S=a(49),E=a(393),x=a(252),O=a(1015),w=a(1016),M=a.n(w),P=a(387),T=a(187),C=a(388),j=a(188),D=a(118);function k(e){return(k="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function e(t){return typeof t}:function e(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(e)}function R(){return(R=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&(e[n]=a[n])}return e}).apply(this,arguments)}function _(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function I(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function L(e,t,a){return t&&I(e.prototype,t),a&&I(e,a),e}function V(e,t){return!t||"object"!==k(t)&&"function"!=typeof t?z(e):t}function z(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function B(e){return(B=Object.setPrototypeOf?Object.getPrototypeOf:function e(t){return t.__proto__||Object.getPrototypeOf(t)})(e)}function F(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&H(e,t)}function H(e,t){return(H=Object.setPrototypeOf||function e(t,a){return t.__proto__=a,t})(e,t)}var W=j.a.Panel,A=T.a.Item,U=c.a.Row,N=c.a.Col,Y={0:"VIDEO",1:"AUDIO"},Q=function(e){function t(e){var a;return _(this,t),(a=V(this,B(t).call(this,e))).searchReset=function(){a.state.value.media_type=0,a.state.value.timeRange[0]=M()(1e3*a.props.defaultParam.startTime),a.state.value.timeRange[1]=M()(1e3*a.props.defaultParam.endTime),a.setState({value:a.state.value}),a.onSearchParamChange()},a.disabledDate=function(e){var t=e&&e.locale("zh-cn").valueOf();return t>=1e3*a.props.defaultParam.startTime&&t<=1e3*a.props.defaultParam.endTime},a.state={value:{media_type:0,timeRange:[M()(0),M()(0)]}},a}return F(t,e),L(t,[{key:"componentDidMount",value:function e(){console.log("search >>> componentDidMount")}},{key:"onSearchParamChange",value:function e(){var t={};t.media_type=Y[this.state.value.media_type],t.startTime=Date.parse(this.state.value.timeRange[0])/1e3,t.endTime=Date.parse(this.state.value.timeRange[1])/1e3,this.props.setMediaSearchParam(t)}},{key:"render",value:function e(){var t=x.a.RangePicker;return this.state.value.timeRange[0]=M()(1e3*this.props.defaultParam.startTime),this.state.value.timeRange[1]=M()(1e3*this.props.defaultParam.endTime),r.a.createElement(j.a,{defaultExpandedKeys:["0"]},r.a.createElement(W,{title:"\u7b5b\u9009"},r.a.createElement(D.FormBinderWrapper,{value:this.state.value,onChange:this.formChange,ref:"form"},r.a.createElement(U,{wrap:!0},r.a.createElement(N,{xxs:"24",l:"8",style:$.formCol},r.a.createElement(A,R({},$.formItemLayout,{label:"\u5a92\u4f53\u7c7b\u578b:"}),r.a.createElement(D.FormBinder,{name:"media_type"},r.a.createElement(S.a,{name:"media_type",defaultValue:Y[0],style:{width:"100%"},dataSource:d.a.generateMapToArray(Y,"value","label")})))),r.a.createElement(N,{xxs:"24",l:"15",style:$.formCol},r.a.createElement("span",{style:$.label},"\u65f6\u95f4\u6bb5:"),r.a.createElement(D.FormBinder,{name:"timeRange"},r.a.createElement(t,{defaultValue:this.state.value.timeRange,showTime:{format:"HH:mm:ss"},disabledDate:this.disabledDate.bind(this)}))),r.a.createElement(N,{xxs:"24",l:"8",style:$.formCol},r.a.createElement(b.a,{onClick:this.onSearchParamChange.bind(this),type:"primary",style:{marginLeft:60}},"\u641c\u7d22"),"\xa0\xa0\xa0",r.a.createElement(b.a,{onClick:this.searchReset.bind(this),type:"primary"},"\u91cd\u7f6e"))))))}}]),t}(n.Component);Q.displayName="mediaSearch",Q.propTypes={},Q.defaultProps={};var $={formCol:{display:"flex",alignItems:"left"},label:{lineHeight:"28px",paddingRight:"10px"},formItemLayout:{labelCol:{fixedSpan:4},wrapperCol:{span:22}}};function q(e){return(q="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function e(t){return typeof t}:function e(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(e)}function J(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function K(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function G(e,t,a){return t&&K(e.prototype,t),a&&K(e,a),e}function X(e,t){return!t||"object"!==q(t)&&"function"!=typeof t?ee(e):t}function Z(e){return(Z=Object.setPrototypeOf?Object.getPrototypeOf:function e(t){return t.__proto__||Object.getPrototypeOf(t)})(e)}function ee(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function te(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&ae(e,t)}function ae(e,t){return(ae=Object.setPrototypeOf||function e(t,a){return t.__proto__=a,t})(e,t)}var ne=c.a.Row,re=c.a.Col,ie=function(e){function t(e){var a;J(this,t),(a=X(this,Z(t).call(this,e))).onChangeMediaPage=function(e){a.state.tableMediaData.list=d.a.getCurrentPageDataList(a.state.tableMediaData.filterList,e,a.state.tableMediaData.pageSize),a.state.tableMediaData.currentPage=e,a.setState({tableMediaData:a.state.tableMediaData})};var n,r,i,o={roomId:a.getQueryVariable("roomId"),userId:a.getQueryVariable("userId"),mediaId:a.getQueryVariable("mediaId")};return a.queryParam=o,a.state={},a.state.tableMediaData={org:[],total:0,pageSize:5,currentPage:1,list:[]},a.state.searchParam={media_type:"VIDEO",startTime:0,endTime:0},Object(y.h)(a.queryParam,a.updateMediaInfo.bind(ee(a))),a}return te(t,e),G(t,[{key:"componentDidMount",value:function e(){}},{key:"componentWillUnmount",value:function e(){}},{key:"initMediaTime",value:function e(t){if(t.length>0){var a=t[0],n=t[t.length-1],r=d.a.getStatMapValue(a,null,"timestamp","VIDEO"),i=d.a.getStatMapValue(n,null,"timestamp","VIDEO");this.state.searchParam.startTime=r,this.state.searchParam.endTime=i}}},{key:"updateMediaInfo",value:function e(t){var a=this.state.tableMediaData;if(null!=t){t.constructor===Array&&t.length>0&&(t=t[0]);var n=[];d.a.ganerateListFromTree(t.statsmaps,n,1),this.state.statsmaps=t.statsmaps,n.sort(function(e,t){return t.time-e.time}),this.initMediaTime(n),a.total=n.length,a.currentPage=1,a.org=n,this.initMediaTime(n);var r=this.state.searchParam,i=this.findStatsMap(r.media_type,r.startTime,r.endTime);a.filterList=i,a.list=d.a.getCurrentPageDataList(a.filterList,1,a.pageSize),this.setState({tableMediaData:a})}else a.total=0,a.currentPage=1,a.org=[],a.list=[],this.setState({tableMediaData:a}),console.log("fetchMediaListData  failed.",t)}},{key:"getQueryVariable",value:function e(t){for(var a,n,r=window.location.toString().split("?")[1].split("&"),i=0;i<r.length;i++){var o=r[i].split("=");if(o[0]==t)return o[1]}return!1}},{key:"renderTextColum",value:function e(t,a){return r.a.createElement("li",{style:oe.infoItemBody},r.a.createElement("span",{style:oe.infoItemLabel},t,":"),r.a.createElement("span",{style:oe.infoItemValue},a))}},{key:"renderTime",value:function e(t){var a=d.a.getOneStatMapValue(t,"timestamp");return Object(h.a)(1e3*a,0)}},{key:"renderRtpMapStats",value:function e(t,a,n){if(null!=a)return r.a.createElement("div",null,a[n],",")}},{key:"renderWebrtcStats",value:function e(t,a){var n=t,i=null;for(var o in n)if(n.hasOwnProperty(o)){i=n[o];break}return r.a.createElement("span",null,this.renderRtpMapStats(this.state.searchParam.media_type,i,a))}},{key:"renderMediaStatsList",value:function e(){var t=this,a,n=this.state.tableMediaData;return r.a.createElement("div",null,r.a.createElement("h3",{style:oe.subTitle},"\u8be6\u7ec6\u5a92\u4f53\u4fe1\u606f:"),r.a.createElement(s.a,{dataSource:n.list,className:"basic-table",style:oe.basicTable,hasBorder:!1},r.a.createElement(s.a.Column,{title:"\u65f6\u95f4",dataIndex:"a",width:150,alignHeader:"left",align:"left",cell:function e(a,n,r){return t.renderTime(r)}}),r.a.createElement(s.a.Column,{title:"\u6536\u5305\u6570",dataIndex:"bytesReceived",width:120,alignHeader:"center",align:"center",cell:function e(a,n,r){return t.renderWebrtcStats(r,"bytesReceived")}}),r.a.createElement(s.a.Column,{title:"\u4e22\u5305\u6570",dataIndex:"info",width:100,cell:function e(a,n,r){return t.renderWebrtcStats(r,"packetsLost")}}),r.a.createElement(s.a.Column,{title:"remb",dataIndex:"info",width:100,cell:function e(a,n,r){return t.renderWebrtcStats(r,"remb")}})),r.a.createElement("div",{style:oe.paginationContainer},r.a.createElement(o.a,{current:n.currentPage,pageSize:n.pageSize,total:n.total,onChange:this.onChangeMediaPage.bind(this)})))}},{key:"findStatsMap",value:function e(t,a,n){for(var r=this.state.tableMediaData.org,i=[],o=0;o<r.length;o++){var l=d.a.getStatMapValue(r[o],null,"timestamp",t);if(l>=a&&l<=n){var s=d.a.getStatMap(r[o],t);null!=s&&i.push(s)}}return i}},{key:"renderMediaStatsCount",value:function e(){var t=this.state.tableMediaData.filterList;if(void 0===t||t.length<1)return console.error("renderMediaStatsCount statsmap = "+t),r.a.createElement("div",null);var a=d.a.getOneStatMapValue(t[t.length-1],"bytesReceived")-d.a.getOneStatMapValue(t[0],"bytesReceived"),n=d.a.getOneStatMapValue(t[t.length-1],"packetsReceived")-d.a.getOneStatMapValue(t[0],"packetsReceived"),i=d.a.getOneStatMapValue(t[t.length-1],"packetsLost")-d.a.getOneStatMapValue(t[0],"packetsLost"),o=d.a.getOneStatMapValue(t[t.length-1],"timestamp"),l=d.a.getOneStatMapValue(t[0],"timestamp"),s=o-l,u=(a/s).toFixed(2)+" \u5b57\u8282/\u79d2",c=(i/n).toFixed(2)+"%";return r.a.createElement("div",null,r.a.createElement("h3",{style:oe.subTitle},"\u7edf\u8ba1\u4fe1\u606f:"),r.a.createElement(ne,{style:oe.anchorCard},r.a.createElement(re,{l:"10"},this.renderTextColum("\u8bb0\u5f55\u5f00\u59cb\u65f6\u95f4",m.a.formatUtcTime(1e3*l))),r.a.createElement(re,{l:"10"},this.renderTextColum("\u8bb0\u5f55\u7ed3\u675f\u65f6\u95f4",m.a.formatUtcTime(1e3*o))),r.a.createElement(re,{l:"10"},this.renderTextColum("\u8bb0\u5f55\u65f6\u957f",m.a.ConvertSectoDay(s)))),r.a.createElement(ne,{style:oe.anchorCard},r.a.createElement(re,{l:"10"},this.renderTextColum("\u63a5\u6536\u5b57\u8282\u6570",a)),r.a.createElement(re,{l:"10"},this.renderTextColum("\u63a5\u6536\u5305\u6570 ",n)),r.a.createElement(re,{l:"10"},this.renderTextColum("\u4e22\u5305\u6570 ",i))),r.a.createElement(ne,{style:oe.anchorCard},r.a.createElement(re,{l:"10"},this.renderTextColum("\u7801\u7387",u)),r.a.createElement(re,{l:"10"},this.renderTextColum("\u4e22\u5305\u7387",c))))}},{key:"setEventSearchParam",value:function e(t){this.state.searchParam=t;var a=this.findStatsMap(t.media_type,t.startTime,t.endTime),n=this.state.tableMediaData;n.filterList=a,n.list=d.a.getCurrentPageDataList(n.filterList,1,n.pageSize),this.setState({tableMediaData:n})}},{key:"render",value:function e(){return r.a.createElement(p.a,{style:oe.cardContainer},r.a.createElement("div",{style:{width:"95%",height:"95%"}},r.a.createElement(Q,{setMediaSearchParam:this.setEventSearchParam.bind(this),defaultParam:this.state.searchParam}),r.a.createElement("hr",null),this.renderMediaStatsList(),r.a.createElement("hr",null),this.renderMediaStatsCount()))}}]),t}(n.Component);ie.displayName="MediaDetailInfo",ie.propTypes={},ie.defaultProps={};var oe={cardContainer:{padding:"10px 10px 20px 10px"},editDialog:{display:"inline-block",marginRight:"5px"},loading:{width:"100%"},header:{display:"flex",justifyContent:"space-between",borderBottom:"1px solid #999"},title:{fontSize:20,margin:0,paddingBottom:10},subTitle:{fontSize:16,fontWeight:"bold",margin:0,marginTop:"20px"},anchorCard:{marginTop:"10px",marginLeft:"20px",background:"#fff",overflow:"hidden",textOverflow:"ellipsis",borderRadius:"4px",display:"flex"},anchorAvatar:{display:"block"},anchorInfoBody:{position:"absolute",left:"0",right:"0",bottom:"0",width:"100%",textAlign:"center",fontSize:"12px"},infoItemBody:{display:"flex",margin:"11px 0"},infoItemLabel:{color:"#000",fontSize:"14px",marginRight:"2px",minWidth:"64px"},infoItemValue:{marginLeft:"5px",color:"#333",fontSize:"14px"},infoItemTitle:{float:"left",maxWidth:"240px",padding:"0 20px",fontSize:"14px",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},infoItemPrice:{float:"right",width:"100px",textAlign:"right",color:"#fe5c38",fontSize:"20px",marginRight:"10px"},contentText:{display:"flex",justifyContent:"center",alignItems:"center",textAlign:"center"}};function le(e){return(le="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function e(t){return typeof t}:function e(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(e)}function se(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function ue(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function ce(e,t,a){return t&&ue(e.prototype,t),a&&ue(e,a),e}function fe(e,t){return!t||"object"!==le(t)&&"function"!=typeof t?pe(e):t}function pe(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function me(e){return(me=Object.setPrototypeOf?Object.getPrototypeOf:function e(t){return t.__proto__||Object.getPrototypeOf(t)})(e)}function de(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&he(e,t)}function he(e,t){return(he=Object.setPrototypeOf||function e(t,a){return t.__proto__=a,t})(e,t)}a.d(t,"default",function(){return ye});var ye=function(e){function t(e){var a;return se(this,t),(a=fe(this,me(t).call(this,e))).state={},a}return de(t,e),ce(t,[{key:"render",value:function e(){return r.a.createElement("div",{className:"RoomList-page"},r.a.createElement(ie,null))}}]),t}(n.Component)},970:function(e,t,a){"use strict";var n=a(14),r=a.n(n),i={dateFormat:function e(t,a){var n={"M+":a.getMonth()+1,"d+":a.getDate(),"h+":a.getHours(),"m+":a.getMinutes(),"s+":a.getSeconds(),"q+":Math.floor((a.getMonth()+3)/3),S:a.getMilliseconds()};for(var r in/(y+)/.test(t)&&(t=t.replace(RegExp.$1,(a.getFullYear()+"").substr(4-RegExp.$1.length))),n)new RegExp("("+r+")").test(t)&&(t=t.replace(RegExp.$1,1==RegExp.$1.length?n[r]:("00"+n[r]).substr((""+n[r]).length)));return t},formatUtcTime:function e(t,a){void 0===a&&(a=0);var n=null,i="\u2014";if(n=new Date(t)){var o=r()(n.getTime()+6e4*a);i=o?o.format("YYYY-MM-DD HH:mm:ss"):{convertTime:t}+" "+{offset:a}}else i={convertTime:t}+" "+{offset:a};return i},getTimeBeforeDays:function e(t){return t<1?0:new Date((new Date).setHours(0,0,0,0)).getTime()-24*(t-1)*60*60*1e3;var a,n},ConvertSectoDay:function e(t){var a="",n=Math.floor(t/86400);t-=3600*n*24;var r=Math.floor(t/3600);t-=3600*r;var i=Math.floor(t/60);return t-=60*i,n>0&&(a+=n+"\u5929 "),r>0&&(a+=r+"\u5c0f\u65f6"),a+=i+"\u5206",a+=t+"\u79d2"}};t.a=i},972:function(e,t,a){"use strict";var n=a(1),r=a.n(n),i=a(970);function o(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),a.push.apply(a,n)}return a}function l(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?o(a,!0).forEach(function(t){s(e,t,a[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):o(a).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))})}return e}function s(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function u(e,t){return e?i.a.formatUtcTime(e,0):r.a.createElement("span",{style:l({},c.contentText)},"No Time")}var c={contentText:{display:"flex",justifyContent:"center",alignItems:"center",textAlign:"center"}};t.a=u}}]);